version: "3.9"

services:
  backend:
    build:
      context: ./backend
    platform: ${LOCAL_DOCKER_PLATFORM:-linux/arm64/v8}
    environment:
      - LLAMA_API_URL=${LLAMA_API_URL:-https://redhataillama-31-8b-instruct-model-service.apps.truist-test.sandbox403.opentlc.com/v1/chat/completions}
      - LLAMA_MODEL=${LLAMA_MODEL:-redhataillama-31-8b-instruct}
      - NEO4J_URI=${NEO4J_URI:-bolt://aadd3663d6966433cb14c2949e347874-822615571.us-east-1.elb.amazonaws.com:7687}
      - NEO4J_USER=${NEO4J_USER:-neo4j}
      - NEO4J_PASSWORD=${NEO4J_PASSWORD:-Neo4jStrongPassword123}
      - NEO4J_DATABASE=${NEO4J_DATABASE:-neo4j}
    ports:
      - "8000:8000"

  frontend:
    build:
      context: ./frontend
    platform: ${LOCAL_DOCKER_PLATFORM:-linux/arm64/v8}
    environment:
      - NEXT_PUBLIC_API_BASE_URL=${NEXT_PUBLIC_API_BASE_URL:-http://localhost:8000}
    ports:
      - "3000:3000"
    depends_on:
      - backend
